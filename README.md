# QQ èŠå¤©è®°å½•æå–å™¨

## ç®€ä»‹

ä» QQ èŠå¤©è®°å½•æ–‡ä»¶ä¸­æå–èŠå¤©ä¿¡æ¯ï¼Œä»…æ”¯æŒ `txt` æ ¼å¼çš„èŠå¤©è®°å½•ã€‚


## å®‰è£…

ä½¿ç”¨ `pip` å®‰è£…ï¼Œè¦æ±‚ `Python 3.9` æˆ–ä»¥ä¸Šç‰ˆæœ¬ã€‚

```bash
> pip install -U qq-chat-history
```

## ä½¿ç”¨

æœ€ç®€å•çš„å¯åŠ¨æ–¹å¼å¦‚ä¸‹ï¼Œå®ƒä¼šè‡ªåŠ¨åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»º `output.json` è¿›è¡Œè¾“å‡ºï¼ˆå¦‚æœå®‰è£…åˆ°è™šæ‹Ÿç¯å¢ƒè¯·ç¡®ä¿å·²æ¿€æ´»ï¼‰ã€‚

```bash
> qq-chat-history /path/to/file.txt
```

å¯åŠ¨æ—¶è¾“å…¥ `--help` å‚æ•°æŸ¥çœ‹æ›´å¤šé…ç½®é¡¹ã€‚

```bash
> qq-chat-history --help
```

æˆ–è€…ï¼Œå¯ä»¥åœ¨ä»£ç ä¸­ä½¿ç”¨ï¼Œå¦‚ä¸‹ï¼š

```python
import qq_chat_history

lines = '''
=========
å‡è£…æˆ‘æ˜¯ QQ è‡ªåŠ¨ç”Ÿæˆçš„æ–‡ä»¶å¤´
=========

1883-03-07 11:22:33 A<someone@example.com>
å…³æ³¨æ°¸é›å¡”è²å–µ
å…³æ³¨æ°¸é›å¡”è²è°¢è°¢å–µ

1883-03-07 12:34:56 B(123123)
TCG

1883-03-07 13:24:36 C(456456)
TCG

1883-03-07 22:00:51 A<someone@example.com>
å¡”è²æ€ä¹ˆä½ äº†
'''.strip().splitlines()

for msg in qq_chat_history.parse(lines):
    print(msg.date, msg.id, msg.name, msg.content)
```

æ³¨æ„ `parse` æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ª `Body` å¯¹è±¡ï¼Œä¸€èˆ¬ä»¥ `Iterable[Message]` çš„å½¢å¼ä½¿ç”¨ã€‚é™¤å¤–ï¼Œ`Body` ä¹Ÿæä¾›äº†å‡ ä¸ªå‡½æ•°ï¼Œ~è™½ç„¶ä¸€èˆ¬ä¹Ÿæ²¡ä»€ä¹ˆç”¨~ã€‚

## Tips

+ åœ¨ `0.3.0+` ç‰ˆæœ¬ä¸­ï¼Œå¯¹äº `parse` æ–¹æ³•çš„å®ç°è¿›è¡Œäº†å¤§è°ƒæ•´ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ª `Body` ç±»ï¼ŒåŸå…ˆæ˜¯ `Iterable[Message]`ã€‚ä½†è¿™å¹¶**ä¸ä¼šå¯¼è‡´å…¼å®¹æ€§é—®é¢˜**ï¼Œå› ä¸º `Body` ä¹Ÿæ˜¯ä¸€ä¸ª `Iterable[Message]`ã€‚

  ä¸åŒçš„æ˜¯ï¼Œ`Body` ç±»ç›¸å¯¹äºåŸå…ˆå•çº¯çš„ç”Ÿæˆå™¨**æä¾›æ›´å¤šåŠŸèƒ½**ï¼Œä¾‹å¦‚`find_xxx` æ–¹æ³•ï¼Œå¯ä»¥ä»æ•°æ®ä¸­æŸ¥æ‰¾æŒ‡å®š `id` æˆ– `name` çš„æ¶ˆæ¯ï¼›`save` æ–¹æ³•å¯ä»¥å°†æ•°æ®ä»¥ `yaml` æˆ– `json` æ ¼å¼ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œè™½ç„¶è¿™ä¸ªå·¥ä½œä¸€èˆ¬éƒ½ç›´æ¥ä»¥ `CLI` æ¨¡å¼å¯åŠ¨æ¥å®Œæˆã€‚

+ åœ¨ `0.3.0+` ç‰ˆæœ¬ä¸­ï¼Œä½ å¯ä»¥å‘ `parse` ä¸­ä¼ å…¥å¤šç§å¤šæ ·çš„ç±»å‹ã€‚

  + `Iterable[str]`ï¼šè¿­ä»£æ¯è¡Œçš„å¯è¿­ä»£å¯¹è±¡ï¼Œå¦‚ `list` æˆ– `tuple` ç­‰ã€‚
  + `TextIOBase`ï¼šæ–‡æœ¬æ–‡ä»¶å¯¹è±¡ï¼Œå¦‚ç”¨ `open` æ‰“å¼€çš„æ–‡æœ¬æ–‡ä»¶ï¼Œæˆ–è€… `io.StringIO` éƒ½å±äºæ–‡æœ¬æ–‡ä»¶å¯¹è±¡ã€‚
  + `str`, `Path`ï¼šæ–‡ä»¶è·¯å¾„ï¼Œå¦‚ `./data.txt`ã€‚

  è¿™äº›å‚æ•°éƒ½å°†è¢«è°ƒç”¨åˆé€‚çš„å·¥å‚æ–¹æ³•æ¥æ„é€  `Body` å¯¹è±¡ã€‚

+ ç”±äº `parse` è¿™ä¸ªåå­—çš„å«ä¹‰æ¯”è¾ƒä¸æ¸…æ™°ï¼Œæ¨èä¸ä¸æ¨èçš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

  ```python
  # Not recommended ğŸ‘
  from qq_chat_history import parse
  parse(...)
  
  
  # Recommended ğŸ‘
  import qq_chat_history
  qq_chat_history.parse(...)
  
  
  from qq_chat_history import parse as parse_qq
  parse_qq(...)
  ```

